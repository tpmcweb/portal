<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authorisation Letter Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            max-width: 600px;
            margin: auto;
        }
        .input-field {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="text"],
        input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Authorisation Letter</h1>

    <div class="input-field">
        <label for="authorizer">Authoriser Name:</label>
        <input type="text" id="authorizer" placeholder="Enter your name">
    </div>

    <div class="input-field">
        <label for="student">Student Name:</label>
        <input type="text" id="student" placeholder="Enter student's name">
    </div>

    <div class="input-field">
        <label for="content">Authorisation Content:</label>
        <input type="text" id="content" placeholder="Enter authorisation content">
    </div>

    <div class="input-field">
        <label for="reason">Authorisation Reason:</label>
        <input type="text" id="reason" placeholder="Enter authorisation reason">
    </div>

    <div class="input-field">
        <label for="startYear">Start Year:</label>
        <input type="number" id="startYear" placeholder="YYYY">
    </div>

    <div class="input-field">
        <label for="startMonth">Start Month:</label>
        <input type="number" id="startMonth" placeholder="MM">
    </div>

    <div class="input-field">
        <label for="startDay">Start Day:</label>
        <input type="number" id="startDay" placeholder="DD">
    </div>

    <div class="input-field">
        <label for="endYear">End Year:</label>
        <input type="number" id="endYear" placeholder="YYYY">
    </div>

    <div class="input-field">
        <label for="endMonth">End Month:</label>
        <input type="number" id="endMonth" placeholder="MM">
    </div>

    <div class="input-field">
        <label for="endDay">End Day:</label>
        <input type="number" id="endDay" placeholder="DD">
    </div>

    <button onclick="generatePDF()">Generate PDF</button>
</div>

<script>
    async function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        const authorizer = document.getElementById('authorizer').value;
        const student = document.getElementById('student').value;
        const content = document.getElementById('content').value;
        const reason = document.getElementById('reason').value;
        const startYear = document.getElementById('startYear').value;
        const startMonth = document.getElementById('startMonth').value;
        const startDay = document.getElementById('startDay').value;
        const endYear = document.getElementById('endYear').value;
        const endMonth = document.getElementById('endMonth').value;
        const endDay = document.getElementById('endDay').value;

        // Generate a random document number between 1111111111111111 and 9999999999999999
        const docNumber = Math.floor(Math.random() * (9999999999999999 - 1111111111111111 + 1)) + 1111111111111111;

        // Add school name at the top
        doc.setFont("Helvetica", "normal");
        doc.setFontSize(22);
        doc.text("Tai Po Methodist Centre", 105, 30, null, null, 'center');

        // Set PDF title
        doc.setFontSize(16);
        doc.text("Authorisation Letter", 105, 40, null, null, 'center');

        // Add notice with Document No.
        doc.setFontSize(12);
        doc.text("Notice: This letter is only valid for a limited time.", 10, 55);
        doc.text("This letter is automatically generated by TPMC Portal.", 10, 60);
        doc.text(`Document No. ${docNumber}`, 10, 65);

        // Add second divider line
        doc.line(10, 70, 200, 70);

        // Add authoriser information
        doc.setFontSize(11);
        doc.text(`I, ${authorizer}, hereby authorise the student ${student} to ${content},`, 10, 80);
        doc.text(`for the following reason: ${reason}.`, 10, 85);
        doc.text(`with authorisation period from ${startYear}-${startMonth}-${startDay} to ${endYear}-${endMonth}-${endDay}.`, 10, 90);
        
        // Add detailed authorisation content
        doc.text("The authorisation includes but is not limited to the following:", 10, 100);
        doc.text("1. Participation in school activities and extracurricular activities;", 10, 105);
        doc.text("2. Access to various resources provided by the school;", 10, 110);
        doc.text("3. Learning and development opportunities within the school and its affiliates.", 10, 115);
        
        // Add spacing before closing remarks
        doc.text("", 10, 125);
        doc.text("If you have any questions, please feel free to contact me.", 10, 130);
        doc.text("Thank you for your cooperation and support.", 10, 135);

        // Add spacing before "Sincerely" and signature
        doc.text("", 10, 145);
        doc.text("Sincerely,", 10, 150);
        
        // Add signature line aligned to the right
        const signatureY = 160;
        const signatureX = 190; // Right margin
        doc.text("____________________", signatureX, signatureY, null, null, 'right');
        doc.text(`Signature: ${authorizer}`, signatureX, signatureY + 5, null, null, 'right');

        // Set PDF security (no editing)
        doc.setProperties({
            title: 'Authorisation Letter',
            subject: 'Authorisation Document',
            author: authorizer,
            keywords: 'authorisation, letter, pdf',
            creator: 'Authorisation Letter Generator'
        });
        doc.save('Authorisation_Letter.pdf');
    }
</script>

</body>
</html> 